===
navigate to test page
%require
===
plwr -S plwr-test open "http://localhost:8599/index.html"
---

===
start video recording
===
plwr -S plwr-test video-start
---
Video recording started

===
do something while recording
===
plwr -S plwr-test reload
---

===
stop recording and save as webm
===
plwr -S plwr-test video-stop /tmp/plwr-test-recording.webm
---
Saved recording to /tmp/plwr-test-recording.webm

===
video file exists
===
test -f /tmp/plwr-test-recording.webm
---

===
video file has content
===
bash -c 'size=$(wc -c < /tmp/plwr-test-recording.webm); echo "$size"; test "$size" -gt 0'
---

===
start recording before interaction
===
plwr -S plwr-test video-start
---
Video recording started

===
interact with page during recording (fill, click, navigate)
===
plwr -S plwr-test open "http://localhost:8599/form.html"
plwr -S plwr-test fill '#name' 'Video Test User'
plwr -S plwr-test click '#btn'
plwr -S plwr-test text '#result'
---
Hello, Video Test User

===
stop recording with output path
===
plwr -S plwr-test video-stop /tmp/plwr-test-interaction.webm
---
Saved recording to /tmp/plwr-test-interaction.webm

===
interaction video file is a valid webm with meaningful size
===
bash -c 'size=$(wc -c < /tmp/plwr-test-interaction.webm | tr -d " "); echo "${size} bytes"; test "$size" -gt 1000'
---
{{ output }}
---
where
* output contains "bytes"

===
start third recording for stop-without-output test
===
plwr -S plwr-test video-start
---
Video recording started

===
do something while recording
===
plwr -S plwr-test reload
---

===
stop recording without output path
===
plwr -S plwr-test video-stop
---
Video stopped.
