===
navigate to test page
%require
===
plwr -S plwr-test open "http://localhost:8599/index.html"
---

===
start video recording
===
plwr -S plwr-test video-start --dir /tmp/plwr-test-video
---
{{ output }}
---
where
* output contains "Video recording started"

===
do something while recording
===
plwr -S plwr-test reload
---

===
stop recording and save as webm
===
plwr -S plwr-test video-stop /tmp/plwr-test-recording.webm
---
Saved recording to /tmp/plwr-test-recording.webm

===
video file exists
===
test -f /tmp/plwr-test-recording.webm
---

===
video file has content
===
bash -c 'size=$(wc -c < /tmp/plwr-test-recording.webm); echo "$size"; test "$size" -gt 0'
---

===
start second recording for stop-without-output test
===
plwr -S plwr-test video-start --dir /tmp/plwr-test-video2
---
{{ output }}
---
where
* output contains "Video recording started"

===
do something while recording
===
plwr -S plwr-test reload
---

===
stop recording without output path
===
plwr -S plwr-test video-stop
---
{{ output }}
---
where
* output contains "Video stopped"
